У меня две задачи (lca и rmq) оказались очень связанными и интересными. Для того, чтобы реализовать lca я использовал rmq+-1 (что более узкий случай по сравнению с rmq). Для того, чтобы решить задачу rmq+-1 использовал алгоритм Фарака-Колтона и Бендера. Сложность для rmq+-1 составила O(n) на построение (по сравнению с O(nlogn) для общего rmq на разряженных таблицах) и O(1) на нахождения минимума.  

Таким образом получаю решение lca с построением O(n) и нахождением общего предка за O(1).  
Потом я использовал алгоритм lca ( O(n), O(1) ) для решения rmq. Только предварительно надо было построить декартово дерево по неявному ключу.  
Это дерево:
* Корнем дерева является элемент массива, имеющий минимальное значение A, скажем A[i]. Если минимальных элементов несколько, можно взять любой. 
* Левым поддеревом является декартово дерево на массиве A[1..i−1]. 
* Правым поддеревом является декартово дерево на массиве A[i+1..N]. 

Его построение реализовал за O(n) - кроме построения ничего и не требуется. Таким образом получил rmq (O(n), O(1)) :)

Внимание. Я не делал доп проверок на то, что в lca подано именно дерево, и др проверк на дурака. Ситаю, что подается дерево с >=1 вершиной. В rmq массив должен быть длины >= 1
