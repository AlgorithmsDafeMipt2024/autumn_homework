# 1.8. Критерий существования Эйлерова пути и цикла в ориентированном и неориентированном графе. Поиск эйлерова пути и цикла.

## Эйлеров путь и Эйлеров цикл

**Эйлеров путь** — это путь в графе, который проходит по каждому рёберу ровно один раз.

**Эйлеров цикл** — это цикл в графе, который проходит по каждому рёберу ровно один раз и возвращается в начальную вершину.

## Критерии существования Эйлерова пути и цикла

### Эйлеров путь в неориентированном графе

Неориентированный граф имеет Эйлеров путь, если:
- Граф связан (есть путь между любой парой вершин).
- Количество вершин с нечётной степенью равно 2 (Эйлеров путь начинается в одной вершине с нечётной степенью и заканчивается в другой).

### Эйлеров цикл в неориентированном графе

Неориентированный граф имеет Эйлеров цикл, если:
- Граф связан.
- Каждая вершина имеет чётную степень.

### Эйлеров путь в ориентированном графе

Ориентированный граф имеет Эйлеров путь, если:
- Граф связан (игнорируя направление рёбер).
- Количество вершин, у которых степень входа и степень выхода не равны, должно быть 0 или 2. Если 0, то путь — это Эйлеров цикл. Если 2, то путь начинается в вершине с на 1 больше степенью выхода, чем входа, и заканчивается в вершине с на 1 больше степенью входа, чем выхода.

### Эйлеров цикл в ориентированном графе

Ориентированный граф имеет Эйлеров цикл, если:
- Граф связан (игнорируя направление рёбер).
- Степени входа и выхода для каждой вершины одинаковы.

---

## Поиск Эйлерова пути и цикла

### Алгоритм поиска Эйлерова пути и цикла (метод Флёри)

Алгоритм поиска Эйлерова пути или цикла можно реализовать с использованием метода Флёри. Этот метод работает, начиная с произвольной вершины (для Эйлерова цикла — с любой вершины, для Эйлерова пути — с вершины с нечётной степенью) и пошагово выбирает рёбра для обхода.

### Псевдокод алгоритма:

```text
FleuryEulerianPath(Graph):
    If not EulerianPathExists(Graph):
        Return "No Eulerian Path Exists"
    
    Stack = empty stack
    StartVertex = choose a starting vertex (either vertex with odd degree for path or any vertex for cycle)
    Add StartVertex to Stack
    
    While Stack is not empty:
        vertex = Stack.top()
        If there is an unused edge from vertex:
            Choose an unused edge (if there is exactly one unused edge, choose it; otherwise, use Fleury’s rule to avoid bridges)
            Remove edge from graph
            Add the other vertex of the edge to Stack
        Else:
            Pop vertex from Stack
    Return path (or cycle) as a sequence of vertices
```

#### Объяснение псевдокода

1. Проверяем существование Эйлерова пути или цикла в графе.
   - Для Эйлерова пути: граф должен быть связан, и должны быть 0 или 2 вершины с нечётной степенью.
   - Для Эйлерова цикла: граф должен быть связан, и для каждой вершины степень входа должна равняться степени выхода.

2. Выбираем начальную вершину:
   - Для Эйлерова пути выбираем вершину с нечётной степенью, если она есть.
   - Для Эйлерова цикла выбираем любую вершину.

3. Пока в стеке есть вершины:
   - Извлекаем вершину и проверяем, есть ли неиспользованные рёбра, исходящие из неё.
   - Если такие рёбра есть, выбираем одно, убираем его из графа и добавляем вершину, к которой оно ведёт, в стек.
   - Если рёбер нет, извлекаем вершину из стека.

4. После обработки всех рёбер возвращаем путь или цикл.

### Сложность алгоритма

- **Время работы:** \( O(E) \), где \( E \) — количество рёбер в графе, так как каждый шаг алгоритма обрабатывает одно ребро.
- **Память:** \( O(V + E) \), где \( V \) — количество вершин, так как требуется хранить граф, стэк для обхода и информацию о посещенных рёбрах.

---

## Заключение

Алгоритм поиска Эйлерова пути и цикла эффективен и работает за линейное время \( O(E) \), что делает его подходящим для анализа больших графов. Эйлеров путь и цикл играют ключевую роль в задачах, связанных с оптимизацией маршрутов, анализом сетей и других приложений в теории графов, где важно пройти по всем рёбрам ровно один раз.
