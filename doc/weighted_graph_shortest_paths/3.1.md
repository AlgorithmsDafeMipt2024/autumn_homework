# 3.1. Алгоритм Дейкстры. Доказательство корректности(с доказательством) Оценка времени работы. Дерево кратчайших путей.

## Алгоритм Дейкстры

**Алгоритм Дейкстры** — это жадный алгоритм для нахождения кратчайших путей от одной вершины до всех остальных в графе с неотрицательными весами рёбер. Алгоритм строит кратчайшие пути пошагово, расширяя уже найденные пути по мере прохождения графа.

### Описание алгоритма:
1. **Инициализация**:
   - Для каждой вершины графа задаём начальные значения расстояний: расстояние до исходной вершины равно 0, а для всех остальных вершин — бесконечность.
   - Создаём приоритетную очередь (или список) для хранения вершин, отсортированных по расстоянию.

2. **Основной цикл**:
   - Пока очередь не пуста:
     1. Извлекаем вершину \( u \) с минимальным расстоянием из очереди.
     2. Для всех соседей вершины \( u \) обновляем их расстояния, если найден более короткий путь через вершину \( u \).
     3. Повторяем, пока все вершины не будут обработаны.

3. **Результат**:
   - Алгоритм завершает выполнение, когда все вершины обработаны, и для каждой вершины будет найдено её минимальное расстояние от начальной.

---

## Доказательство корректности алгоритма Дейкстры

**Теорема:** Алгоритм Дейкстры корректно находит кратчайшие пути от исходной вершины до всех остальных вершин в графе с неотрицательными весами рёбер.

### Доказательство:

1. **Предположение**:
   Пусть на каждом шаге алгоритма верно, что для всех уже обработанных вершин найдено наименьшее возможное расстояние от исходной вершины.

2. **Инициализация**:
   На начальном шаге расстояние до исходной вершины \( S \) равно 0, а до всех остальных вершин — бесконечность. Алгоритм правильно устанавливает начальные значения.

3. **Итерация**:
   На каждом шаге алгоритм извлекает вершину \( u \) с минимальным расстоянием из очереди и обновляет расстояния до её соседей. Пусть на шаге алгоритм извлек вершину \( u \) с минимальным расстоянием. Для любой вершины \( v \), которая ещё не обработана, если существует путь \( u \to v \), то новое расстояние до \( v \) через \( u \) будет не больше текущего расстояния, поскольку на каждом шаге выбирается минимальное расстояние.

4. **Обоснование корректности**:
   Алгоритм не может обновить расстояние до вершины на шаге, когда эта вершина уже была извлечена из очереди, поскольку на этом шаге её расстояние минимально. Таким образом, алгоритм гарантирует, что для каждой вершины найдено минимальное расстояние.

**Заключение**: Алгоритм Дейкстры корректен, так как всегда находит кратчайшие пути благодаря жадному выбору вершины с минимальным расстоянием.

---

## Оценка времени работы

### Время работы:
- **Без использования приоритетной очереди**:
  Алгоритм проходит по всем рёбрам и вершинам. Время работы составляет \( O(V^2) \), где \( V \) — количество вершин в графе.
  
- **С использованием приоритетной очереди (с бинарной кучей)**:
  Каждую вершину можно извлекать из очереди за \( O(\log V) \) времени. Обновление расстояний для каждой вершины также занимает \( O(\log V) \), если используется приоритетная очередь.
  
  Таким образом, для графа с \( V \) вершинами и \( E \) рёбрами время работы алгоритма с использованием приоритетной очереди будет:

  \[
  O((V + E) \log V)
  \]

  Это значительно быстрее, чем без очереди, особенно для разреженных графов.

---

## Дерево кратчайших путей

После выполнения алгоритма Дейкстры для каждой вершины графа можно восстановить кратчайший путь от исходной вершины до данной вершины, начиная с конечной вершины и двигаясь по цепочке предшествующих вершин. Эти связи образуют **дерево кратчайших путей**.

1. **Построение дерева**:
   Каждая вершина сохраняет предшествующую вершину в пути, через которую было найдено минимальное расстояние. В результате, из этих связей можно построить дерево, в котором корнем является исходная вершина, а рёбрами — кратчайшие пути.

2. **Использование дерева**:
   Дерево кратчайших путей может быть полезно для восстановления самих путей, а также для анализа структуры графа и оптимизации маршрутов.

---

## Заключение

- **Алгоритм Дейкстры** — это эффективный жадный алгоритм для поиска кратчайших путей от одной вершины до всех остальных в графе с неотрицательными весами рёбер.
- **Доказательство корректности** показывает, что алгоритм всегда находит минимальные пути благодаря жадному выбору вершины с минимальным расстоянием на каждом шаге.
- **Оценка времени работы** подтверждает, что использование приоритетной очереди снижает сложность алгоритма до \( O((V + E) \log V) \), что делает его практичным для работы с большими графами.
- **Дерево кратчайших путей** является полезной структурой данных, которая позволяет восстановить сам путь от исходной вершины до других вершин графа.
