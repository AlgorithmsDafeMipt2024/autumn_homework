# 4.3. Теорема о разрезе. Доказательство.

## Формулировка теоремы

**Теорема о разрезе:**  
Пусть \( G = (V, E) \) — взвешенный связный граф, \( S \) — произвольное подмножество вершин графа, такое что \( S \subset V \), а \( T = V \setminus S \). Разрез \((S, T)\) состоит из всех рёбер, имеющих один конец в \( S \), а другой — в \( T \). Если ребро \((u, v)\) имеет минимальный вес среди всех рёбер разреза \((S, T)\), то существует минимальное остовное дерево, которое содержит ребро \((u, v)\).

### Замечания:
- Теорема утверждает, что для минимального остовного дерева можно безопасно выбирать минимальное ребро разреза на каждом шаге, чтобы обеспечить оптимальное решение.
- Эта теорема лежит в основе жадных алгоритмов, таких как алгоритмы Краскала и Прима.

## Доказательство

Рассмотрим граф \( G = (V, E) \), где ребро \((u, v)\) имеет минимальный вес среди всех рёбер разреза \((S, T)\). Докажем, что в минимальном остовном дереве \( T_{MST} \) обязательно содержится это ребро.

### Допущения:
1. Пусть \( T_{MST} \) — минимальное остовное дерево графа.
2. Предположим, что \( T_{MST} \) не содержит ребра \((u, v)\).

### Шаг 1. Построение альтернативного дерева:
- Если ребро \((u, v)\) не включено в \( T_{MST} \), то, поскольку \( T_{MST} \) является остовным деревом, существует путь из \( u \) в \( v \) через другие рёбра \( T_{MST} \).
- Добавим ребро \((u, v)\) в \( T_{MST} \). Это создаёт цикл в дереве.

### Шаг 2. Замена рёбра в цикле:
- В цикле, образованном добавлением \((u, v)\), выберем ребро \((x, y)\), принадлежащее \( T_{MST} \), которое соединяет \( S \) и \( T \), но имеет больший вес, чем \( w(u, v) \). Такое ребро всегда существует, так как \((u, v)\) минимальное по весу в разрезе.
- Заменим ребро \((x, y)\) на \((u, v)\). Полученное дерево остаётся остовным, но его общий вес становится меньше, чем у \( T_{MST} \).

### Противоречие:
- Мы получили остовное дерево с меньшим весом, чем \( T_{MST} \), что противоречит предположению о том, что \( T_{MST} \) — минимальное остовное дерево.

### Вывод:
- Предположение о том, что \( T_{MST} \) не содержит ребра \((u, v)\), неверно. Следовательно, ребро \((u, v)\) должно входить в минимальное остовное дерево.

## Заключение

Теорема о разрезе подтверждает, что минимальное ребро любого разреза обязательно входит в минимальное остовное дерево. Это свойство позволяет эффективно использовать жадные подходы в алгоритмах Краскала и Прима, систематически выбирая рёбра для минимального остовного дерева.
