# 4.6. Алгоритм Крускала. Доказательство корректности. Оценка времени работы.

## Введение

Алгоритм Крускала — жадный алгоритм для построения минимального остовного дерева (МОД). Он упорядочивает все рёбра графа по возрастанию веса и поэтапно добавляет рёбра в дерево, избегая циклов. Доказательство корректности алгоритма базируется на **теореме о разрезе**.

---

## Псевдокод алгоритма Крускала

1. Инициализируйте:
   - \( T \) ← ∅ (множество рёбер минимального остовного дерева).
   - Отсортируйте все рёбра \( E \) графа по возрастанию веса.
   - Создайте структуру данных для представления компонент связности (например, систему непересекающихся множеств — Union-Find).

2. Для каждого ребра \( (u, v) \) из \( E \) в порядке возрастания веса:
   - Если \( u \) и \( v \) принадлежат разным компонентам связности:
     - Добавьте \( (u, v) \) в \( T \).
     - Объедините компоненты связности, содержащие \( u \) и \( v \).

3. Завершите, когда в \( T \) будет \( |V| - 1 \) рёбер.

4. Верните \( T \) как минимальное остовное дерево.

---

## Доказательство корректности алгоритма

### Шаг 1. Обоснование выбора рёбер
- Алгоритм Крускала добавляет рёбра в \( T \) в порядке возрастания веса.
- Согласно **теореме о разрезе**, минимальное ребро разреза между двумя компонентами связности графа обязательно входит в МОД.
- Алгоритм гарантирует, что добавляемые рёбра минимальны и не образуют циклов благодаря проверке компонент связности.

### Шаг 2. Жадный подход
- На каждом шаге добавляется ребро, минимизирующее суммарный вес, при условии, что оно не создаёт цикла. Это согласуется с жадным подходом.

### Шаг 3. Построение МОД
- Алгоритм завершает работу, когда в \( T \) содержится \( |V| - 1 \) рёбер. Поскольку граф связен, \( T \) покрывает все вершины и образует остовное дерево.

### Шаг 4. Оптимальность
- Любое остовное дерево, построенное алгоритмом Крускала, минимально, так как каждое добавляемое ребро является оптимальным выбором на каждом шаге.

---

## Оценка времени работы

Основные этапы алгоритма:

1. **Сортировка рёбер**:
   - Используется стандартная сортировка, например, Timsort или QuickSort.
   - Сложность: \( O(E \log E) \).

2. **Объединение компонент связности**:
   - Реализуется с помощью структуры данных Union-Find.
   - Для каждой операции объединения или поиска: \( O(\alpha(V)) \), где \( \alpha \) — обратная функция Аккермана.
   - Для \( E \) операций: \( O(E \alpha(V)) \).

Итоговая сложность:
- \( O(E \log E + E \alpha(V)) \).
- В графе с \( |E| = O(V^2) \): \( O(E \log V) \), так как \( \log E = \log V^2 = 2 \log V \).

---

## Заключение

Алгоритм Крускала эффективно строит минимальное остовное дерево, используя жадный подход и структуру Union-Find. Его сложность \( O(E \log V) \) делает алгоритм подходящим для разреженных графов. Доказательство корректности следует из теоремы о разрезе, которая гарантирует, что добавляемые рёбра всегда входят в минимальное остовное дерево.
