# 5.4. Теорема Форда-Фалкерсона.

## Формулировка теоремы

Для сети \( G = (V, E) \) с пропускными способностями \( c(u, v) \geq 0 \) и истоком \( s \) и стоком \( t \), максимальный поток \( |f| \) равен минимальной пропускной способности разреза \( c(S, T) \):
\[
|f| = c(S, T),
\]
где \( (S, T) \) — разрез сети, такой что \( s \in S \), \( t \in T \), а \( c(S, T) \) определяется как:
\[
c(S, T) = \sum_{u \in S, v \in T} c(u, v).
\]

---

## Доказательство

### Основа доказательства:
Алгоритм Форда-Фалкерсона строит поток \( f \) итеративно, увеличивая поток по дополняющим путям, пока они существуют.

### Шаги доказательства:

1. **Начальный поток**:
   Изначально поток \( f(u, v) = 0 \) для всех рёбер \( (u, v) \in E \). Поток \( f \) удовлетворяет условиям:
   - Ограничения пропускной способности: \( f(u, v) \leq c(u, v) \),
   - Закон сохранения потока: \( \sum_{u \in V} f(u, v) = \sum_{u \in V} f(v, u) \), \( \forall v \neq s, t \).

2. **Дополняющие пути**:
   Пока в остаточной сети \( G_f \) существует дополняющий путь \( P \), поток \( f \) увеличивается на величину \( \Delta f \), равную минимальной остаточной пропускной способности вдоль пути \( P \).

3. **Завершение алгоритма**:
   Алгоритм завершится, когда в остаточной сети \( G_f \) больше не будет дополняющих путей. На этом этапе поток \( f \) является максимальным.

4. **Свойство разреза**:
   При отсутствии дополняющего пути значение потока \( |f| \) через любой разрез \( (S, T) \) равно пропускной способности разреза:
   \[
   |f| = c(S, T).
   \]

### Вывод:
Алгоритм гарантирует, что \( |f| = c(S, T) \), где разрез \( (S, T) \) минимален по пропускной способности.

---

## Сложность алгоритма

### Оценка времени работы:
- В худшем случае количество итераций равно числу увеличений потока:
  \[
  O(E \cdot F),
  \]
  где \( F \) — значение максимального потока, \( E \) — число рёбер.
- При использовании поиска в ширину (алгоритм Эдмондса-Карпа) сложность снижается до \( O(VE^2) \), где \( V \) — число вершин.

---

## Применения

- Оптимизация транспортных сетей.
- Решение задач максимального паросочетания.
- Анализ графов, моделирующих потоки информации, жидкости или электричества.

---

## Заключение

Теорема Форда-Фалкерсона формулирует фундаментальную связь между максимальным потоком и минимальным разрезом в сети. Она является основой для разработки многих алгоритмов оптимизации и анализа сетей.
