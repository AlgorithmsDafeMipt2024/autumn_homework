# 5.6. Алгоритм Эдмондса-Карпа. Доказательство, что кратчайшее расстояние в остаточной сети не уменьшается.

## Описание алгоритма

Алгоритм Эдмондса-Карпа — это реализация алгоритма Форда-Фалкерсона, в которой дополняющий путь выбирается с использованием поиска в ширину (BFS). Таким образом, каждый найденный путь является кратчайшим (по числу рёбер) в остаточной сети.

### Основные шаги:

1. **Инициализация**:
   Установить начальный поток \( f(u, v) = 0 \) для всех рёбер.

2. **Поиск дополняющего пути**:
   Использовать BFS для нахождения пути \( P \) из истока \( s \) в сток \( t \) в остаточной сети \( G_f \).

3. **Увеличение потока**:
   Найти минимальную остаточную пропускную способность вдоль пути \( P \) — \( \Delta f \). Обновить поток вдоль прямых и обратных рёбер пути.

4. **Повторение**:
   Повторять шаги 2–3, пока в остаточной сети \( G_f \) существуют дополняющие пути.

5. **Завершение**:
   Когда дополняющих путей больше нет, текущий поток \( f \) является максимальным.

### Сложность:
Время работы алгоритма: \( O(VE^2) \), где \( V \) — число вершин, \( E \) — число рёбер.

---

## Доказательство: кратчайшее расстояние в остаточной сети не уменьшается

### Утверждение:
При каждом обновлении потока кратчайшее расстояние (в числе рёбер) от истока \( s \) до стока \( t \) в остаточной сети \( G_f \) не уменьшается.

### Доказательство:

1. **Начальное состояние**:
   В начале кратчайшее расстояние от \( s \) до \( t \) вычисляется с помощью BFS. Все рёбра имеют остаточную пропускную способность \( c_f(u, v) = c(u, v) \).

2. **Изменение остаточной сети**:
   При увеличении потока вдоль пути \( P \):
   - Остаточная пропускная способность рёбер на пути \( P \) уменьшается.
   - Появляются обратные рёбра с положительной пропускной способностью.

3. **Свойство BFS**:
   BFS находит путь \( P \), который имеет минимальное количество рёбер. После обновления потока:
   - Остаточная сеть \( G_f \) изменяется, но любые рёбра с \( c_f(u, v) = 0 \) исключаются из поиска.
   - Новые обратные рёбра, добавленные в \( G_f \), увеличивают длину путей.

4. **Отсутствие укорочения**:
   Дополняющий путь в новой остаточной сети не может быть короче, так как:
   - BFS всегда находит минимальный путь.
   - Уменьшение пропускной способности рёбер на пути \( P \) исключает эти рёбра из использования до тех пор, пока не будет найден обратный путь.

5. **Вывод**:
   Каждое новое значение потока связано с тем, что дополняющий путь имеет не меньшее количество рёбер, чем предыдущий.

---

## Заключение

Алгоритм Эдмондса-Карпа использует поиск в ширину для нахождения кратчайших дополняющих путей, что гарантирует, что расстояние от \( s \) до \( t \) в остаточной сети никогда не уменьшается. Это свойство упрощает доказательство корректности алгоритма и обеспечивает полиномиальную оценку времени работы.
