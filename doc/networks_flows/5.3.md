# 5.3. Понятие остаточной сети. Понятие дополняющего пути. Необходимость отсутствия дополняющего пути для максимальности потока.

## Понятие остаточной сети

**Остаточная сеть** для сети \( G = (V, E) \) с текущим потоком \( f \) — это граф \( G_f = (V, E_f) \), где:
- Множество вершин совпадает с вершинами исходной сети: \( V(G_f) = V(G) \),
- Множество рёбер \( E_f \) определяется остаточной пропускной способностью:
  - Если \( (u, v) \in E \), то ребро \( (u, v) \in E_f \) включается в остаточную сеть с весом (остаточной пропускной способностью):
    \[
    c_f(u, v) = c(u, v) - f(u, v),
    \]
    где \( c(u, v) \) — пропускная способность ребра \( (u, v) \), а \( f(u, v) \) — текущий поток через это ребро.
  - Если поток \( f(u, v) > 0 \), то добавляется обратное ребро \( (v, u) \) с остаточной пропускной способностью:
    \[
    c_f(v, u) = f(u, v).
    \]

Таким образом, остаточная сеть позволяет учитывать как свободное место для увеличения потока по прямому направлению, так и возможность уменьшения потока по обратному.

---

## Понятие дополняющего пути

**Дополняющий путь** (augmenting path) в остаточной сети \( G_f \) — это путь из истока \( s \) в сток \( t \), на котором все рёбра имеют положительную остаточную пропускную способность:
\[
c_f(u, v) > 0 \quad \forall (u, v) \in P.
\]

Поток вдоль дополняющего пути может быть увеличен на величину:
\[
\Delta f = \min_{(u, v) \in P} c_f(u, v),
\]
где минимум берётся по всем рёбрам пути \( P \).

---

## Необходимость отсутствия дополняющего пути для максимальности потока

### Теорема:
Поток \( f \) в сети является **максимальным** тогда и только тогда, когда в остаточной сети \( G_f \) отсутствует дополняющий путь.

### Доказательство необходимости:

1. Если в \( G_f \) существует дополняющий путь \( P \), то поток \( f \) можно увеличить:
   - Добавляем \( \Delta f \) к потоку вдоль всех рёбер \( (u, v) \in P \) в прямом направлении.
   - Вычитаем \( \Delta f \) вдоль всех обратных рёбер \( (v, u) \in P \).

2. После увеличения потока \( f' = f + \Delta f \), его значение \( |f'| \) возрастает:
   \[
   |f'| = |f| + \Delta f.
   \]
   Таким образом, \( f \) не является максимальным.

### Доказательство достаточности:

1. Если в остаточной сети \( G_f \) нет дополняющего пути, то:
   - Для любого разреза \( (S, T) \), поток через разрез \( f(S, T) \) достигает максимального значения:
     \[
     |f| = c(S, T),
     \]
     где \( c(S, T) \) — суммарная пропускная способность рёбер разреза.
   - Поток нельзя увеличить без нарушения условий сохранения потока и пропускной способности.

2. Следовательно, \( f \) является максимальным.

---

## Физическая интерпретация

- Остаточная сеть представляет собой возможные пути для увеличения потока с учётом текущего распределения.
- Дополняющий путь указывает на "запас" сети для увеличения пропускной способности.
- Когда дополняющих путей больше не существует, это означает, что все возможные маршруты для увеличения потока исчерпаны, и поток становится максимальным.

---

## Заключение

Остаточная сеть и дополняющие пути лежат в основе алгоритмов нахождения максимального потока, таких как алгоритм Форда-Фалкерсона и его улучшения. Отсутствие дополняющих путей является необходимым и достаточным условием максимальности потока, что обеспечивает корректность данных методов.
