# Система Непересекающихся Множеств (Disjoint Set Union, DSU)

## Система Непересекающихся Множеств (или DSU) — это структура данных, позволяющая работать с множеством непересекающихся подмножеств и эффективно выполнять две ключевые операции:

1. Объединение (union): соединяет два множества в одно.
2. Нахождение представителя (find): возвращает представителя множества, к которому принадлежит элемент.

Эта структура данных часто применяется в задачах на графы, таких как построение минимального остовного дерева или поиск компонент связности.

## Основные идеи

Для повышения эффективности операций используются два подхода:

- Сжатие пути (Path Compression): при нахождении представителя для каждого элемента мы устанавливаем прямой путь к представителю, что значительно ускоряет последующие операции find.
- Случайный приоритет (Union by Rank/Size): при объединении двух множеств меньшее множество добавляется к большему, что уменьшает высоту дерева и снижает сложность операций.

## Асимптотика работы

С применением сжатия пути и объединения по рангу операции find и union выполняются за амортизированное время O(α(n)), где α — обратная функция Аккермана, которая для практически всех значимых значений n меньше 5.

## Построение минимального остовного дерева с использованием DSU

Алгоритм Крускала использует DSU для построения минимального остовного дерева (МСТ) в графе. Основная идея алгоритма заключается в последовательном добавлении ребер с наименьшим весом, избегая образования циклов. DSU помогает проверить, находятся ли два узла в одном компоненте, чтобы избежать циклов.

## Шаги алгоритма Крускала

1. Отсортировать все ребра графа по возрастанию веса.
2. Создать DSU для отслеживания компонентов связности.
3. Инициализировать переменные для хранения общего веса минимального остовного дерева.
4. Для каждого ребра в отсортированном списке:
   - Если его концы принадлежат разным компонентам, добавить это ребро в МСТ и объединить компоненты.
5. Алгоритм завершен, когда в МСТ добавлено ровно V - 1 ребер (где V — количество вершин).